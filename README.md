# F13 Tech HR Management System (HRMS)

A modern, serverless Human Resources Management System designed to streamline employee-related operations. This application provides a secure and intuitive portal for employees to manage their profiles, submit leave requests, provide performance feedback, and upload essential documents.

The project is built on a robust AWS serverless architecture with a React.js frontend and an automated CI/CD pipeline for seamless deployments.

## Table of Contents

1.  [Features](#features)
2.  [Architecture Overview](#architecture-overview)
3.  [Technology Stack](#technology-stack)
4.  [Getting Started (Local Development & AWS Setup)](#getting-started-local-development--aws-setup)
    * [AWS Prerequisites](#aws-prerequisites)
    * [Local Development Setup](#local-development-setup)
5.  [Deployment (CI/CD Pipeline)](#deployment-cicd-pipeline)
    * [Backend Deployment (AWS SAM)](#backend-deployment-aws-sam)
    * [Frontend Deployment (S3 Static Hosting)](#frontend-deployment-s3-static-hosting)
    * [CI/CD with AWS CodePipeline](#cicd-with-aws-codepipeline)
6.  [Project Structure](#project-structure)
7.  [Troubleshooting Common Issues](#troubleshooting-common-issues)
8.  [Future Improvements](#future-improvements)
9.  [Contributing](#contributing)
10. [License](#license)

---

## Features

* **Secure User Authentication:** Employee registration, login, and account verification (6-digit code via email) using Amazon Cognito.
* **Employee Profile Management:** View and update personal and professional details.
* **Leave Request System:** Submit new leave requests (sick, casual, earned, etc.) and view leave history.
* **Performance Feedback:** Provide and track self-appraisal or general performance feedback.
* **Secure Document Uploads:** Upload various document types (payslips, ID proofs etc.) securely to Amazon S3 using pre-signed URLs, with metadata stored in DynamoDB.
* **Responsive UI:** A clean, modern, and responsive user interface built with React.js and Tailwind CSS.
* **Automated Deployment:** Full CI/CD pipeline ensuring continuous integration and continuous delivery.

## Architecture Overview

The HRMS leverages a modern serverless architecture on AWS, minimizing operational overhead and ensuring scalability.

```

\+----------------+       +-------------------+       +-----------------+       +-----------------+
|   Employee     |       |   Amazon API      |       |   AWS Lambda    |       |  Amazon DynamoDB|
|  (Web Browser) |------\>|      Gateway      |------\>|  (Python)       |------\>|    (Data Store) |
|                |       |    (F13HRMSApi)   |       | (auth\_handler,  |       |                 |
|                |       |                   |       |  profile\_manager,|       |   +-----------+
\+----------------+       | +---------------+ |       |  leave\_manager, |       |   | S3 Bucket |
^               | |   Cognito     | |       |  feedback\_manager,|------\>|   |  (Documents)|
| (S3 Static)   | |  Authorizer   |\<-------|  document\_manager) |       |   +-----------+
|               | +---------------+ |       |                 |       |
\+----------------+       +-------------------+       +-----------------+       +-----------------+
| Amazon S3      |
| (Frontend Hosting) |
\+----------------+

\+--------------------+
|  CI/CD Pipeline    |
| (CodeCommit/GitHub)|
| (CodeBuild)        |
| (CodePipeline)     |
| (AWS SAM)          |
\+--------------------+

````

* **Frontend (React.js):** Hosted on **Amazon S3** as a static website, accessible via its public URL.
* **API Gateway:** Acts as the entry point for all API requests from the frontend. It routes requests to specific Lambda functions and enforces authentication via **Cognito User Pool Authorizers** for protected routes.
* **Lambda Functions (Python):** Backend logic for all HRMS functionalities. Each Lambda integrates with other AWS services.
* **DynamoDB:** Used as the primary data store for structured HR data (profiles, leaves, feedback, document metadata).
* **S3 (Documents):** Dedicated S3 bucket for storing uploaded employee documents. Secure uploads are managed via **pre-signed URLs** generated by a Lambda function.
* **Cognito User Pools:** Manages user authentication, signup, login, and verification processes.
* **IAM:** Manages permissions for all AWS services to interact securely.
* **CI/CD:** Automated deployment orchestrated by **AWS CodePipeline**, using **AWS CodeBuild** for building frontend and backend artifacts, and **AWS SAM** for defining and deploying the backend infrastructure as code.

## Technology Stack

* **Frontend:**
    * React.js
    * Tailwind CSS
    * HTML5, CSS3, JavaScript
* **Backend:**
    * AWS Lambda (Python 3.9+)
    * Amazon API Gateway (REST API)
    * Amazon DynamoDB (NoSQL Database)
    * Amazon S3 (Object Storage for documents and static website hosting)
    * Amazon Cognito (User Management & Authentication)
    * Boto3 (AWS SDK for Python)
* **Infrastructure as Code (IaC):**
    * AWS Serverless Application Model (SAM)
    * AWS CloudFormation
* **CI/CD:**
    * AWS CodeCommit / GitHub (Source Control)
    * AWS CodeBuild
    * AWS CodePipeline
* **Other Tools:**
    * AWS CLI
    * SAM CLI
    * npm / Yarn

---

## Getting Started (Local Development & AWS Setup)

### AWS Prerequisites

Before running the application or deploying, ensure you have the following AWS resources configured manually (or ensure your SAM template creates/references them correctly).

1.  **AWS Account:** An active AWS account.
2.  **AWS CLI:** Configured with credentials that have sufficient permissions (`AdministratorAccess` for initial setup, then narrow down).
3.  **S3 Buckets:**
    * **Frontend Hosting Bucket:** An S3 bucket (e.g., `hr-management-system-frontend`) configured for static website hosting, **publicly accessible** (`s3:GetObject` permission, "Block Public Access" OFF).
    * **Documents Storage Bucket:** An S3 bucket (e.g., `f13tech-hrms-documents-youruniqueid`) where uploaded documents will be stored.
    * **SAM Artifacts Bucket:** A private S3 bucket (e.g., `your-hrms-sam-artifacts-YOURACCOUNTID`) for SAM to stage deployment artifacts.
4.  **Cognito User Pool:**
    * An Amazon Cognito User Pool (e.g., `F13HRMSUserPool`).
    * A **Public App Client** (e.g., `F13HRMSAppClient`) associated with your User Pool, **NOT configured to generate a client secret**.
    * Ensure Email verification is enabled in the User Pool settings.
5.  **IAM Roles:**
    * **Lambda Execution Role:** A role (e.g., `F13HRMSLambdaRole`) that Lambda functions will assume, with permissions for DynamoDB, S3, Cognito, and CloudWatch Logs (refer to `backend/template.yaml` for policies).
    * **CodeBuild Service Role:** A role (e.g., `CodeBuildServiceRoleHRMS`) for CodeBuild to access S3 (artifacts), CloudFormation, Lambdas etc.
    * **CodePipeline Service Role:** A role (e.g., `CodePipelineServiceRoleHRMS`) for CodePipeline itself.
    * **CloudFormation Deploy Role:** A role (e.g., `CloudFormationDeployRoleHRMS`) for CloudFormation to perform deployments (trust policy for `cloudformation.amazonaws.com`).

### Local Development Setup

1.  **Clone the Repository:**
    ```bash
    git clone [https://github.com/your-username/your-hrms-repo.git](https://github.com/your-username/your-hrms-repo.git)
    cd your-hrms-repo
    ```
2.  **Node.js & npm (for Frontend):**
    * Ensure Node.js (v18+) and npm (or Yarn) are installed on your machine.
    * Navigate to the frontend directory:
        ```bash
        cd frontend/
        npm install # or yarn install
        ```
    * Go back to the root: `cd ..`
3.  **Python (for Backend):**
    * Ensure Python 3.9+ is installed.
    * Install pip (if not already present).
    * Install AWS SAM CLI:
        ```bash
        pip install aws-sam-cli
        ```
4.  **Update `backend/template.yaml`:**
    * Open `backend/template.yaml`.
    * **Crucially, update the `Default` values for the `S3DocumentsBucketName`, `CognitoUserPoolId`, and `CognitoAppClientId` parameters** with your actual AWS resource names/IDs.

5.  **Update `frontend/src/App.js`:**
    * Open `frontend/src/App.js`.
    * **Update the `API_BASE_URL` constant** with your actual API Gateway Invoke URL once it's deployed.
    * If running locally for testing *before* pipeline deployment, temporarily set `API_BASE_URL` to your manually deployed API Gateway URL.

## Deployment (CI/CD Pipeline)

This project uses an automated CI/CD pipeline orchestrated by **AWS CodePipeline** to deploy both the frontend and backend.

### Backend Deployment (AWS SAM)

The backend is deployed using AWS SAM, which leverages CloudFormation.
1.  **SAM Build:** `sam build --template-file backend/template.yaml` (executed by CodeBuild).
2.  **SAM Deploy:** `sam deploy --stack-name F13-HRMS-Backend-Stack --s3-bucket YOUR_SAM_ARTIFACTS_BUCKET --template-file .aws-sam/build/template.yaml --capabilities CAPABILITY_IAM CAPABILITY_NAMED_IAM --region YOUR_REGION` (executed by CodeBuild/CloudFormation).

### Frontend Deployment (S3 Static Hosting)

The frontend is built and then synced to an S3 bucket configured for static website hosting.
1.  **React Build:** `npm run build` (executed by CodeBuild).
2.  **S3 Sync:** `aws s3 sync frontend/build/ s3://YOUR_FRONTEND_S3_BUCKET/ --delete` (executed by CodeBuild/CodePipeline).

### CI/CD with AWS CodePipeline

1.  **Create CodeCommit Repository:** (If using CodeCommit) Push your entire project to a new repository (e.g., `your-hrms-repo`).
2.  **Configure CodeBuild Project:**
    * Name: `HRMSBackendAndFrontendBuild`
    * Source: Link to your Git repository (CodeCommit/GitHub).
    * Buildspec: Refer to `buildspec.yml` in the repository root.
    * Artifacts: Output to your SAM artifacts S3 bucket.
3.  **Configure CodePipeline:**
    * Name: `HRMSDeploymentPipeline`
    * **Source Stage:** Link to your Git repository (triggers on `main` branch push).
    * **Build Stage:** Link to your `HRMSBackendAndFrontendBuild` CodeBuild project.
    * **Deploy Stage:**
        * **Action 1 (Frontend):** S3 action to sync `BuildArtifact` (your `frontend/build` content) to your frontend hosting S3 bucket. Ensure "Extract file before deploy" and "Remove other files from bucket" are checked.
        * **Action 2 (Backend):** CloudFormation action to `Create or update a stack`.
            * Stack name: `F13-HRMS-Backend-Stack`
            * Template: `BuildArtifact::backend/template.yaml`
            * Capabilities: `CAPABILITY_IAM`, `CAPABILITY_NAMED_IAM`
            * Parameter Overrides: Pass values for `S3DocumentsBucketName`, `CognitoUserPoolId`, `CognitoAppClientId` (e.g., `Param1=Value1,Param2=Value2`).
            * Role: Use the `CloudFormationDeployRoleHRMS` you created.
4.  **Trigger Deployment:** A `git push` to your `main` branch will automatically trigger the pipeline. Monitor its progress in the CodePipeline console.

---

## Project Structure

````

your-hrms-repo/
├── .github/                      \# GitHub Actions workflows (if using GitHub)
│   └── workflows/
│       └── deploy.yml            \# Example GitHub Actions workflow
├── frontend/                     \# React.js application
│   ├── public/                   \# Static assets (including index.html)
│   ├── src/                      \# React source code (App.js, components)
│   ├── package.json
│   └── ...
├── backend/                      \# Python Lambda function source code
│   ├── auth\_handler.py           \# User authentication (signup, login, confirm, resend)
│   ├── common\_utils.py           \# Utility functions (e.g., get\_user\_id\_from\_event, get\_response)
│   ├── profile\_manager.py        \# Employee profile CRUD operations
│   ├── leave\_manager.py          \# Leave request submission and retrieval
│   ├── feedback\_manager.py       \# Performance feedback submission and retrieval
│   ├── document\_manager.py       \# Document metadata management, pre-signed URL generation
│   └── template.yaml             \# AWS SAM template for backend infrastructure (Lambdas, API Gateway, DynamoDB)
├── buildspec.yml                 \# AWS CodeBuild instructions for pipeline
└── README.md

```

---

## Troubleshooting Common Issues

* **Frontend Not Updating:**
    * **Browser Cache:** Always hard refresh (`Ctrl+Shift+R` or `Cmd+Shift+R`) or use Incognito mode.
    * **S3 Sync Issue:** Ensure "Remove other files from bucket" and "Extract file before deploy" are checked in your CodePipeline S3 deploy action.
* **"Unauthorized" Errors from API Gateway (Lambda logs don't exist):**
    * **API Gateway Method Authorization:** For the failing API Gateway method, go to "Method Request" and ensure "Authorization" is set to `NONE` if the frontend is not sending a JWT, or `CognitoUserPoolAuthorizer` if it is and the token is correctly passed.
    * **Lambda Resource-Based Policy:** In the Lambda's "Permissions" tab, verify the "Resource-based policy" allows `apigateway.amazonaws.com` to `lambda:InvokeFunction`. The `Condition`'s `AWS:SourceArn` must precisely match your API Gateway's ARN for that path. Re-linking the Lambda in API Gateway "Integration Request" usually fixes this.
* **"Internal Server Error" from API Gateway (Lambda logs *do* exist):**
    * **Check CloudWatch Logs:** Go to the specific Lambda function's CloudWatch logs (`/aws/lambda/your-function-name`). Look for `ERROR` messages or Python tracebacks.
    * **`NoneType` or Data Mismatch:** If the error is a `TypeError: argument of type 'NoneType' is not iterable`, your Lambda is likely expecting data in a different part of the `event` object (e.g., query string vs. JSON body). Ensure `common_utils.py`'s `get_user_id_from_event` is robustly handling different `event` structures.
    * **IAM Permissions (Lambda Execution Role):** Verify the IAM role attached to the Lambda has permissions for *all* AWS services it interacts with (DynamoDB `PutItem`, `GetItem`, S3 `PutObject`, `GetObject` etc.).
* **CI/CD Pipeline Fails:**
    * **GitHub Webhook:** If connecting to GitHub, ensure the AWS Connector GitHub App has proper permissions on your repository and you haven't hit GitHub API rate limits.
    * **IAM Roles:** Verify that all IAM roles (CodeBuild, CodePipeline, CloudFormation Deploy) have correct trust policies (allowing the correct AWS service to assume them) and sufficient permissions.
    * **SAM Template Errors:** If the "Deploy" stage fails (CloudFormation), check the CloudFormation stack events for detailed errors (often syntax errors in `template.yaml` or resource conflicts).

---

## Future Improvements

* **Granular IAM Policies:** Replace broad `*FullAccess` policies with fine-grained, least-privilege IAM policies.
* **Enhanced Frontend UX:** Add loading spinners, better form validation feedback, pagination/filtering for lists, and more comprehensive error messages.
* **Admin Dashboard:** Develop a dedicated interface for HR administrators to manage users, approve leaves, etc.
* **Password Reset Flow:** Implement a "Forgot Password" flow via Cognito.
* **Advanced Features:** Expand with payroll, expense claims, multi-party feedback, and employee directory.
* **Automated Testing:** Integrate unit, integration, and end-to-end tests into the CI/CD pipeline.
* **Multiple Environments:** Extend the CI/CD pipeline to deploy to `dev`, `staging`, and `prod` environments.
* **Custom Domains & HTTPS:** Configure custom domain names with SSL certificates for the frontend and API Gateway.
* **Error Monitoring:** Integrate with dedicated error monitoring tools (e.g., AWS X-Ray, Sentry).
